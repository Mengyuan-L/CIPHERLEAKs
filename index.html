---
layout: default
title: Home
---
{% if page.url == "/" %}

<link rel="stylesheet" href="{{ "/assets/css/uikit.min.css" | relative_url }}">
  <script type="text/javascript" src="{{ "/assets/js/uikit.min.js " | relative_url }}"></script>
  <script type="text/javascript" src="{{ "/assets/js/uikit-icons.min.js " | relative_url }}"></script>


<!-- Featured
================================================== -->
<section class="introductions">
    <!-- <nav style="background-color:black;"> -->
    <div class="section-title">
        <h2><span>What is CIPHERLEAKs?</span></h2>
    </div>
  <div class="col-sm-12 col-md-6 mt-3 mt-md-0">
    <div class="embed-responsive embed-responsive-16by9">
      <iframe class="embed-responsive-item" src="https://www.youtube.com/embed/Gsv8QJbXU90" allowfullscreen></iframe>
    </div>
  </div>
  <br />
<br />
    <!-- </nav> -->
</section>

<!-- Featured
================================================== -->
<section class="featured-posts">
    <!-- <nav style="background-color:white;"> -->
    <div class="section-title">
        <h2><span>Root causes of the vulnerability</span></h2>
    </div>
    <div class="row">
<p style="padding-left: 1em;">
     Two features in the design of SEV (and SEV-SNP) caused this vulnerability 
</p>
<ul id="afb0b8ef-c0be-4c43-ab30-b87eb9685230" class="bulleted-list"><li>SEV hardware encrypts the VM&#x27;s memory using 128-bit AES symmetric encryption. The AES engine integrated into the AMD System-on-Chip (SOC) automatically encrypts the data when it is written to the memory and automatically decrypts the data when it is read from memory. Latest SEV processors adopt the XOR-Encrypt-XOR (XEX) encryption mode in the memory encryption where the ciphertext is calculated by <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>=</mo><mi>E</mi><mi>N</mi><mi>C</mi><mo stretchy="false">(</mo><mi>m</mi><mo>⊕</mo><mi>T</mi><mo stretchy="false">(</mo><msub><mi>P</mi><mi>m</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>⊕</mo><mi>T</mi><mo stretchy="false">(</mo><msub><mi>P</mi><mi>m</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">c=ENC(m\oplus T(P_m))\oplus T(P_m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">ENC</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span>. The 128-bit entropy tweak function <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T()</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span> fixed all existing vulnerabilities in SEV AES encryption. However, the same plaintext always has the same ciphertext in system physical address <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">P_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> during the lifetime of a guest VM.</li></ul><ul id="6fa343c6-a877-455e-a7b4-0179ca85d57a" class="bulleted-list"><li>For performance optimization, SEV (including SEV-ES and SEV-SNP) does not prevent the hypervisor from read accessing the ciphertext of the encrypted memory. </li></ul>
    </div>
<!-- </nav> -->
</section>


<!-- Featured
================================================== -->
<section class="featured-posts">
    <!-- <nav style="background-color:black;"> -->
    <div class="section-title">
        <h2><span>Ciphertext side channels</span></h2>
    </div>
    <div class="row">
<p style="padding-left: 1em;"><span style="border-bottom:0.05em solid"><i>By monitoring the changes in the ciphertext of the victim VM, the adversary is able to infer the changes of the corresponding plaintext</i></span>. This ciphertext side channel may seem innocuous at first glance, but when applied to certain encrypted memory regions, it may be exploited to infer the execution of the victim VM. Specifically, we target at monitoring the ciphertext of the VM Save Area (VMSA). We particularly construct two attack primitives: execution state inference and plaintext recovery.  Execution state inference can help locate the physical address of targeted functions and infer the executing function of a process. The ciphertext side channel can also be exploited to recover the plaintext from some of the ciphertext blocks. To recover plaintext from the ciphertext, the adversary first needs to build a dictionary of plaintext-ciphertext pairs for the targeted registers, and then make use of the dictionary to recover the plaintext value of the registers of interest during the execution of a sensitive application.</p>
    </div>
<!-- </nav> -->
</section>

<!-- Featured
================================================== -->
<section class="featured-posts">
    <!-- <nav style="background-color:white;"> -->
    <div class="section-title">
        <h2><span>Case studies</span></h2>
    </div>
    <div class="row">
<p style="padding-left: 1em;">We present two case studies to illustrate the CIPHERLEAKs attack. In the first attack, we show that the constant-time RSA implementation in OpenSSL can be broken with known ciphertext for the plaintext values of 0 to 31 (which can be easily collected during VM&#x27;s lifecycle). In the second attack, we show that the constant-time ECDSA signature can be compromised with known ciphertext of the plaintext values of 0 and 1. In both of the two cases we presented, the adversary can recover the private key <i>d</i> of RSA encryption and the secret nonce <i>k</i> in ECDSA signature with 100% accuracy.</p>
    </div>
<!-- </nav> -->
</section>

<!-- Featured
================================================== -->
<section class="featured-posts">
    <!-- <nav style="background-color:black;"> -->
    <div class="section-title">
        <h2><span>Disclosure</span></h2>
    </div>
    <div class="row">
<p style="padding-left: 1em;">We disclosed the vulnerability of the ciphertext side channel and the CIPHERLEAKs attack to AMD team. AMD engineers have acknowledged the vulnerability on SEV, SEV-ES, and SEV-SNP, and filed an embargo that is effective until August 10, 2021. As of the time of writing, CVE number, CVE-2020-12966, has been reserved for the vulnerability. AMD also announces a security bulletin together with a hardware patch for SEV-SNP in August 2021 (<a href="https://www.amd.com/en/corporate/product-security/bulletin/amd-sb-1013">https://www.amd.com/en/corporate/product-security/bulletin/amd-sb-1013</a>).</p>
    </div>
<!-- </nav> -->
</section>


<script>
   function fullwindowpopup(){
      window.open("newpopup.html","bfs","fullscreen,scrollbars")
   }
</script>

  <!-- UiKit Javascript -->
<!--   <div class="uk-section uk-align-center"> -->
    <div>
        <h2>Research Paper</h2>
    <div class="uk-container uk-container-small">
        <div class="uk-child-width-1-2@m uk-grid-match uk-text-center uk-margin-medium-top" data-uk-grid="">   
            <div>
                <div class="uk-card uk-card-default uk-box-shadow-medium uk-card-hover uk-card-body uk-inline border-radius-large uk-border-rounded">
                    <a class="uk-position-cover" href="/CIPHERLEAKs/setupYourSEV"></a>
                    <div class="uk-card-badge uk-label">Docs</div>
                    <h3 class="uk-card-title uk-margin">Read our paper</h3>
                    <p>Read more details about CIPHERLEAKs.</p>
                    
                </div>
            </div>
            <div>
                <div class="uk-card uk-card-default uk-box-shadow-medium uk-card-hover uk-card-body uk-inline border-radius-large uk-border-rounded">
                    <a class="uk-position-cover" href="/CIPHERLEAKs/bibtex"></a>
                    <div class="uk-card-badge uk-label">Cite</div>
                    <h3 class="uk-card-title uk-margin">Cite our paper</h3>
                    <p>Explore AMD SEV.</p>
                    
                </div>
            </div>
    </div>
</div>
<!-- </div> -->

</section>

<!-- Featured
================================================== -->
<section class="featured-posts">
    <div class="section-title">
        <h2><span>People</span></h2>
    </div>
    <div>
<p id="05f89406-1c2f-428c-aeb5-293af2a916a7" class=""><a href="http://web.cse.ohio-state.edu/~li.7533/">Mengyuan Li (The Ohio State University)</a></p>
<p id="9ee9cd76-093c-4bb2-b6dd-29c9eabbd68d" class=""><a href="https://yinqian.org">Yinqian Zhang (Southern University of Science and Technology)</a></p>
<p id="b555d8b3-5cde-45ac-ac4e-13986719900e" class=""><a href="https://www.linkedin.com/in/huibo-melody-wang-5034b410a">Huibo Wang (Baidu Security)</a></p>
<p id="6e94ecf4-5353-45ec-ae83-f765fab8b994" class=""><a href="https://scholar.google.com/citations?user=uhb5cYsAAAAJ&amp;hl=zh-CN">Kang Li (Baidu Security)</a></p>
<p id="22256b39-3068-4f81-9dcc-09b289858f7b" class=""><a href="https://sites.google.com/site/strongerwillcheng/">Yueqiang Cheng (NIO Security Research)</a></p>
    </div>
</section>

<!-- Featured
================================================== -->
<section class="featured-posts">
    <div class="section-title">
        <h2><span>Q&amp;A</span></h2>
    </div>
    <div>
<ul id="1f6ed9f4-2b2f-4fdd-866b-c09ce5f72459" class="toggle"><li><details><summary><big><b>Who is affected by CIPHERLEAKs?</b></big></summary><p id="bfe9992a-feba-4e25-ba61-bb3225fe91dd" class="">All SEV, SEV-ES and SEV-SNP are affected by CIPHERLEAKs, which are supported by AMD EPYC server processors. </p></details></li></ul><ul id="c7d33be0-f483-482a-8cbd-1cdc4fd5ebad" class="toggle"><li><details><summary><big><b>What is SEV?</b></big></summary><p id="bc7dcc8b-8ba9-4d98-8d52-6d801a6111fb" class="">AMD’s Secure Encrypted Virtualization (SEV) is an extension of the AMD Virtualization (AMD-V) technology. It provides security features, such as memory encryption and isolation to virtual machines (VM), in order to support scenarios like confidential cloud computing where hypervisors are not trusted to respect the security of the VMs. When SEV is enabled, the memory pages used by a guest VM are transparently encrypted by a secure co-processor using an ephemeral key that is unique to each VM, thus allowing the guest VMs to compute on encrypted memory. SEV is AMD&#x27;s ambitious movement towards confidential cloud computing, which is gaining traction in the cloud industry. For instance, Google Cloud recently provides SEV feature in its cloud computing service. Customers now can setup
SEV-enabled VMs, called Confidential VMs, as its first product of Confidential Computin</p></details></li></ul><ul id="cb9b3ef2-ef32-4fcc-b694-e0e0d784cca7" class="toggle"><li><details><summary><big><b>What is SEV-SNP?</b></big></summary><p id="7841322c-79cc-4270-afcd-f0e6e58aa6b2" class="">To address the attacks against SEV that exploit memory integrity flaws, AMD recently announced SEV Secure Nested Paging (SEV-SNP) and released a whitepaper describing its high-level functionality in January 2020. SEV-SNP protects guest VM&#x27;s memory integrity by introducing a new structure called Reverse Map Table (RMP). The source code for SEV-SNP software support can be found <a href="https://github.com/AMDESE/AMDSEV/tree/sev-snp-devel">here</a>.  </p></details></li></ul><ul id="b82760ba-8146-456d-b780-00e29a57c774" class="toggle"><li><details><summary><big><b>Which SEV generations are affected?</b></big></summary><p id="e991c15b-5b38-4890-af8c-c4dbb3291b7e" class="">CIPHERLEAKs can affect SEV (the original generation), SEV-ES (the second generation) and SEV-SNP (the third and the latest generation). </p></details></li></ul><ul id="9b22af0c-2e34-4aec-a4cf-3d9e6a817d81" class="toggle"><li><details><summary><big><b>What is CVE-2020-12966?</b></big></summary><p id="6c2534ea-f7d2-46cc-afd3-f212e232b455" class="">CVE stands for Common Vulnerabilities and Exposures and CVE-2020-12966 is the official record of CIPHERLEAKs attack. </p></details></li></ul><ul id="06b2068a-01a4-49ae-b9d5-1be5e4f69b54" class="toggle"><li><details><summary><b><big>Are there some software patches available? </b></big></summary><p id="6831e7ae-5b45-412f-add2-38b8fa4e9542" class="">Unfortunately, CIPHERLEAKs attack can collect the function&#x27;s internal state by Advanced Programmable Interrupt Controller (APIC). Thus, no software solutions may work properly. Some hardware-level patches are expected. </p></details></li></ul><ul id="72567c61-174f-4f56-95fd-e4475eacf6d3" class="toggle"><li><details><summary><big><b>What hardware migrations are available for CIPHERLEAKs?</b></big></summary><p id="d5488887-1225-49c7-9d4c-d188539cedc1" class="">AMD plans to hardware patch CIPHERLEAKs in the future. For more information, please refer to <a href="https://www.amd.com/en/corporate-product-security-bulletin-amd-sb-1013">https://www.amd.com/en/corporate-product-security-bulletin-amd-sb-1013</a>.</p></details></li></ul><ul id="cea5b7d5-9afc-4680-a411-7f4fd4ffd1bc" class="toggle"><li><details><summary><big><b>What is Constant-time Cryptography?</b></big></summary><p id="e5005dd3-e413-4039-858e-11bd7a5c11f8" class="">Constant-time cryptography implementations are widely used in mainstream cryptography libraries to mitigate timing attacks, the design of constant-time functions is used to reduce or eliminate data-dependent timing information. Specifically, Constant-time implementations are making the execution time independent of the secret variables, therefore, do not leak any secret information to timing analysis. </p><p id="6eff09ab-6e3b-4a22-a6a1-f0d13d47b431" class="">To achieve constant execution time, there are three rules to follow. First, the control-flow paths cannot depend on the secret information. Second, the accessed memory addresses can not depend on the secret information. Third, the inputs to variable-time instructions such as division and modulus cannot depend on the secret information.</p></details></li></ul>
    </div>
</section>

<br />
<br />


<!-- Featured
================================================== -->
<section class="featured-posts">
    <div class="section-title">
        <h2><span>Essential Links</span></h2>
    </div>
    <div>
    <h3>Documents</h3>
        <ul>
            <li>
                <strong>[SEV]</strong> <a href="https://developer.amd.com/wordpress/media/2013/12/AMD_Memory_Encryption_Whitepaper_v7-Public.pdf">AMD Memory Encryption</a>
                    <ul>
                        <li><a href="https://www.amd.com/system/files/TechDocs/55766_SEV-KM_API_Specification.pdf">SEV API</a></li>
                    </ul>
            </li>

            <li>
                <strong>[SEV-ES]</strong>  <a href="https://www.amd.com/system/files/TechDocs/Protecting%20VM%20Register%20State%20with%20SEV-ES.pdf">Protecting VM Register State With SEV-ES</a>
                    <ul>
                        <li><a href="https://www.amd.com/system/files/TechDocs/55766_SEV-KM_API_Specification.pdf">SEV-ES API</a></li>
                        <li><a href="https://developer.amd.com/wp-content/resources/56421.pdf">Guest Hypervisor Communication Block (GHCB) Standardization</a></li>
                    </ul>
            </li>

            <li>
                <strong>[SEV-SNP]</strong> <a href="https://www.amd.com/system/files/TechDocs/SEV-SNP-strengthening-vm-isolation-with-integrity-protection-and-more.pdf">AMD SEV-SNP</a>
                    <ul>
                        <li><a href="https://www.amd.com/system/files/TechDocs/56860.pdf">SEV Secure Nested Paging Firmware ABI Specification</a></li>
                    </ul>
            </li>

            <li>
                <strong>[Manual]</strong> <a href="https://www.amd.com/system/files/TechDocs/24593.pdf">AMD64 Architecture Programmer’s Manual Volume 2</a>
            </li>

        </ul>

    <h3>SEV Software support</h3>
        <ul>
            <li>
                <strong>[Software Support]</strong> <a href="https://github.com/AMDESE/AMDSEV">How to setup AMD SEV</a>
                    <ul>
                        <li><a href="https://github.com/AMDESE/AMDSEV/tree/sev-es">SEV-ES Branch</a></li>
                    </ul>
                    <ul>
                        <li><a href="https://github.com/AMDESE/AMDSEV/tree/sev-snp-devel">SEV-SNP Branch</a></li>
                    </ul>
            </li>

            <li>
                <strong>[SEV-Tool]</strong>  <a href="https://github.com/AMDESE/sev-tool"> AMD SEV Tool for managing SEV platform certificates</a>
            </li>

            <li>
                <strong>[Container]</strong>  <a href="https://github.com/AMDESE/runtime">SEV runtime for Kata Containers</a>
            </li>
        </ul>
    </p> 
</div>

    </div>
</section>

<br />
<br />



{% endif %}

